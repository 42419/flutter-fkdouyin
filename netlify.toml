[build]
  # Netlify 默认没有 Flutter，所以我们需要在构建时下载它
  # 增加判断：如果 _flutter 目录已存在，则跳过 clone，直接更新或使用
  command = "if [ ! -d \"_flutter\" ]; then git clone https://github.com/flutter/flutter.git -b stable --depth 1 _flutter; fi && export PATH=\"$PWD/_flutter/bin:$PATH\" && flutter pub get && flutter build web --release && node tools/hash_web.js"
  publish = "build/web"

# 处理 SPA 路由重定向，防止刷新页面报 404
[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200
